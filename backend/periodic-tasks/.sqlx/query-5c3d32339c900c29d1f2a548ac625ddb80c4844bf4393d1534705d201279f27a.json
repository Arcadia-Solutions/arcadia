{
  "db_name": "PostgreSQL",
  "query": "\n\t\t\tSELECT\n\t\t\t\tCOALESCE(\n\t\t\t\t\tjsonb_agg(\n\t\t\t\t\t\tjsonb_build_object(\n\t\t\t\t\t\t\t'id', sp.id,\n\t\t\t\t\t\t\t'created_at', sp.created_at,\n\t\t\t\t\t\t\t'subject', sp.subject,\n\t\t\t\t\t\t\t'created_by', json_build_object(\n\t\t\t\t\t\t\t\t'id', u_creator.id,\n\t\t\t\t\t\t\t\t'username', u_creator.username,\n\t\t\t\t\t\t\t\t'banned', u_creator.banned,\n\t\t\t\t\t\t\t\t'warned', u_creator.warned\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t'resolved', sp.resolved,\n\t\t\t\t\t\t\t'last_message', jsonb_build_object(\n\t\t\t\t\t\t\t\t'created_at', lm.created_at,\n\t\t\t\t\t\t\t\t'created_by', jsonb_build_object(\n\t\t\t\t\t\t\t\t\t'id', u_lm.id,\n\t\t\t\t\t\t\t\t\t'username', u_lm.username,\n\t\t\t\t\t\t\t\t\t'warned', u_lm.warned,\n\t\t\t\t\t\t\t\t\t'banned', u_lm.banned\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t)\n\t\t\t\t\t\tORDER BY lm.created_at DESC\n\t\t\t\t\t),\n\t\t\t\t\t'[]'::jsonb\n\t\t\t\t) AS \"staff_pms_json: serde_json::Value\"\n\t\t\tFROM staff_pms sp\n\t\t\tJOIN LATERAL (\n\t\t\t\tSELECT created_at, created_by_id\n\t\t\t\tFROM staff_pm_messages\n\t\t\t\tWHERE staff_pm_id = sp.id\n\t\t\t\tORDER BY created_at DESC\n\t\t\t\tLIMIT 1\n\t\t\t) lm ON TRUE\n\t\t\tJOIN users u_lm ON lm.created_by_id = u_lm.id\n\t\t\tINNER JOIN users u_creator ON sp.created_by_id = u_creator.id\n\t\t\tWHERE ($2)::bool OR sp.created_by_id = $1;\n\t\t\t",
  "describe": {
    "columns": [
      {
        "ordinal": 0,
        "name": "staff_pms_json: serde_json::Value",
        "type_info": "Jsonb"
      }
    ],
    "parameters": {
      "Left": [
        "Int8",
        "Bool"
      ]
    },
    "nullable": [
      null
    ]
  },
  "hash": "5c3d32339c900c29d1f2a548ac625ddb80c4844bf4393d1534705d201279f27a"
}
