{
  "db_name": "PostgreSQL",
  "query": "\n            WITH artist_counts AS (\n                SELECT\n                    title_group_id,\n                    COUNT(*) as count\n                FROM affiliated_artists\n                WHERE title_group_id = ANY($1)\n                GROUP BY title_group_id\n            )\n            SELECT\n                aa.title_group_id,\n                a.id as artist_id,\n                a.name as artist_name\n            FROM affiliated_artists aa\n            JOIN artists a ON a.id = aa.artist_id\n            JOIN artist_counts ac ON ac.title_group_id = aa.title_group_id\n            WHERE ac.count <= 2\n\n            UNION ALL\n\n            SELECT DISTINCT ON (ac.title_group_id)\n                ac.title_group_id,\n                0::bigint as artist_id,\n                ''::text as artist_name\n            FROM artist_counts ac\n            WHERE ac.count > 2\n            ORDER BY title_group_id, artist_id\n            ",
  "describe": {
    "columns": [
      {
        "ordinal": 0,
        "name": "title_group_id",
        "type_info": "Int4"
      },
      {
        "ordinal": 1,
        "name": "artist_id",
        "type_info": "Int8"
      },
      {
        "ordinal": 2,
        "name": "artist_name",
        "type_info": "Varchar"
      }
    ],
    "parameters": {
      "Left": [
        "Int4Array"
      ]
    },
    "nullable": [
      null,
      null,
      null
    ]
  },
  "hash": "8e836aa4383b324803163fe6dc0699eca85a4d9a75a5d991020d76d867c843ec"
}
